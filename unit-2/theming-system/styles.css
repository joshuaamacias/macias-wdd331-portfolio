/**
 * Product Showcase - Theming System
 * 
 * ARCHITECTURE CHOICE:
 * Choose either CUBE CSS or BEM for organizing your CSS.
 * Document your choice and follow it consistently throughout.
 * 
 * CUBE CSS approach:
 * - Composition: Layout patterns (.flow, .grid, .cluster)
 * - Utilities: Single-purpose classes (.text-center, .font-bold)
 * - Blocks: Component styles (.card, .button)
 * - Exceptions: State variations (add additional classes as needed)
 * 
 * BEM approach:
 * - Blocks: Standalone components (.card)
 * - Elements: Parts of blocks (.card__title, .card__image)
 * - Modifiers: Variations (.card--featured)
 * 
 * ORGANIZATION:
 * You may create additional CSS files if you prefer to separate:
 * - Base styles and custom properties
 * - Layout patterns
 * - Components
 * - Utilities
 * 
 * MODERN CSS FEATURES TO USE:
 * - CSS nesting throughout
 * - Custom properties for theming
 * - color-mix() for color variations
 * - Modern selectors (:is, :where, :has, :not)
 * - Logical properties (margin-inline, padding-block)
 * 
 * REQUIREMENTS:
 * 1. Define theme system with custom properties
 * 2. Implement light and dark themes
 * 3. Support prefers-color-scheme
 * 4. Use color-mix() for color variations
 * 5. Create responsive layout
 * 6. Ensure accessibility (contrast, focus indicators, reduced motion)
 * 7. Style all components and states
 */

/* Your CSS implementation goes here */

:root {
  /* Tell the browser we support both */
  color-scheme: light dark;

  /* Typography */
  --font-sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji",
    "Segoe UI Emoji";
  --step--1: clamp(0.92rem, 0.88rem + 0.2vw, 1rem);
  --step-0: clamp(1rem, 0.95rem + 0.35vw, 1.125rem);
  --step-1: clamp(1.25rem, 1.12rem + 0.8vw, 1.6rem);
  --step-2: clamp(1.6rem, 1.35rem + 1.4vw, 2.2rem);

  /* Spacing */
  --space-1: 0.5rem;
  --space-2: 0.75rem;
  --space-3: 1rem;
  --space-4: 1.5rem;
  --space-5: 2rem;
  --space-6: 3rem;

  /* Radius + shadow */
  --radius-1: 0.5rem;
  --radius-2: 0.9rem;
  --shadow-sm: 0 0.5rem 1.2rem color-mix(in oklch, black 18%, transparent);
  --shadow-lg: 0 1rem 2.6rem color-mix(in oklch, black 22%, transparent);

  /* Base palette (oklch) */
  --brand: oklch(0.62 0.16 250); /* “blue-ish” brand */
  --neutral-0: oklch(0.99 0 0);
  --neutral-1: oklch(0.97 0 0);
  --neutral-2: oklch(0.92 0 0);
  --neutral-8: oklch(0.25 0 0);
  --neutral-9: oklch(0.18 0 0);

  /* Brand scale using color-mix (oklch) */
  --brand-weak: color-mix(in oklch, var(--brand) 20%, white);
  --brand-soft: color-mix(in oklch, var(--brand) 45%, white);
  --brand-strong: color-mix(in oklch, var(--brand) 82%, black);

  /* Semantic tokens (LIGHT default) */
  --color-background: var(--neutral-0);
  --color-surface: var(--neutral-1);
  --color-surface-2: color-mix(in oklch, var(--neutral-1) 80%, var(--brand-weak));
  --color-text: var(--neutral-9);
  --color-text-muted: color-mix(in oklch, var(--neutral-9) 70%, var(--neutral-2));
  --color-heading: var(--neutral-9);

  --color-border: color-mix(in oklch, var(--neutral-2) 78%, var(--neutral-8));
  --color-shadow: color-mix(in oklch, black 20%, transparent);

  --color-primary: var(--brand);
  --color-primary-hover: color-mix(in oklch, var(--brand) 86%, black);
  --color-primary-active: color-mix(in oklch, var(--brand) 74%, black);

  --color-focus: color-mix(in oklch, var(--brand) 62%, white);

  /* Motion */
  --dur-1: 140ms;
  --dur-2: 240ms;
  --ease: cubic-bezier(0.2, 0.8, 0.2, 1);
}

/* Dark theme override (JS toggles this class on <html>) */
.dark-theme {
  --color-background: oklch(0.14 0 0);
  --color-surface: oklch(0.18 0 0);
  --color-surface-2: color-mix(in oklch, var(--color-surface) 78%, var(--brand-strong));
  --color-text: oklch(0.96 0 0);
  --color-text-muted: color-mix(in oklch, var(--color-text) 70%, black);
  --color-heading: oklch(0.98 0 0);

  --color-border: color-mix(in oklch, var(--color-surface) 74%, white);
  --shadow-sm: 0 0.6rem 1.4rem color-mix(in oklch, black 50%, transparent);
  --shadow-lg: 0 1.1rem 3rem color-mix(in oklch, black 55%, transparent);

  --color-primary-hover: color-mix(in oklch, var(--brand) 88%, white);
  --color-primary-active: color-mix(in oklch, var(--brand) 78%, white);

  --color-focus: color-mix(in oklch, var(--brand) 65%, white);
}

/* Support prefers-color-scheme WITHOUT breaking manual light toggle:
   - In system-dark, we only “auto-dark” if the toggle is not explicitly set to aria-pressed="false".
   - Before JS runs, aria-pressed doesn't exist, so it defaults to dark in system-dark.
*/
@media (prefers-color-scheme: dark) {
  :root:not(.dark-theme):not(:has(#theme-toggle[aria-pressed="false"])) {
    --color-background: oklch(0.14 0 0);
    --color-surface: oklch(0.18 0 0);
    --color-surface-2: color-mix(in oklch, var(--color-surface) 78%, var(--brand-strong));
    --color-text: oklch(0.96 0 0);
    --color-text-muted: color-mix(in oklch, var(--color-text) 70%, black);
    --color-heading: oklch(0.98 0 0);
    --color-border: color-mix(in oklch, var(--color-surface) 74%, white);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  :root {
    --dur-1: 0ms;
    --dur-2: 0ms;
  }
}

/* =========================
   BASE
   ========================= */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html {
  block-size: 100%;
}

body {
  margin: 0;
  min-block-size: 100%;
  font-family: var(--font-sans);
  font-size: var(--step-0);
  line-height: 1.55;
  background: var(--color-background);
  color: var(--color-text);
  transition: background-color var(--dur-2) var(--ease), color var(--dur-2) var(--ease);
}

img {
  max-inline-size: 100%;
  block-size: auto;
  display: block;
}

a {
  color: inherit;
}

:where(button) {
  font: inherit;
}

/* Focus (keyboard) */
:where(a, button, [tabindex]):focus-visible {
  outline: 3px solid var(--color-focus);
  outline-offset: 3px;
}

/* =========================
   COMPOSITION (CUBE)
   ========================= */
.flow > * + * {
  margin-block-start: var(--flow-space, var(--space-3));
}

.cluster {
  display: flex;
  flex-wrap: wrap;
  gap: var(--cluster-gap, var(--space-2));
  align-items: center;
}

.grid {
  display: grid;
  gap: var(--grid-gap, var(--space-4));
}

.container {
  inline-size: min(1100px, 100% - 2 * var(--space-4));
  margin-inline: auto;
}

/* =========================
   UTILITIES
   ========================= */
.visually-hidden {
  position: absolute;
  inline-size: 1px;
  block-size: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* =========================
   LAYOUT
   ========================= */
.site-header {
  position: sticky;
  inset-block-start: 0;
  z-index: 10;
  background: color-mix(in oklch, var(--color-surface) 92%, transparent);
  border-block-end: 1px solid var(--color-border);
  backdrop-filter: blur(10px);
  transition: background-color var(--dur-2) var(--ease), border-color var(--dur-2) var(--ease);

  .header-content {
    inline-size: min(1100px, 100% - 2 * var(--space-4));
    margin-inline: auto;
    padding-block: var(--space-3);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-3);
  }

  .site-title {
    font-size: var(--step-1);
    margin: 0;
    letter-spacing: 0.2px;
    color: var(--color-heading);
  }
}

main {
  inline-size: min(1100px, 100% - 2 * var(--space-4));
  margin-inline: auto;
  padding-block: var(--space-6);
}

.site-footer {
  border-block-start: 1px solid var(--color-border);
  padding-block: var(--space-4);
  background: var(--color-surface);

  .footer-text {
    inline-size: min(1100px, 100% - 2 * var(--space-4));
    margin-inline: auto;
    margin-block: 0;
    color: var(--color-text-muted);
    font-size: var(--step--1);
  }
}

/* =========================
   BLOCKS / COMPONENTS
   ========================= */

/* Hero */
.hero {
  padding: clamp(1.25rem, 2.2vw, 2rem);
  border: 1px solid var(--color-border);
  background: var(--color-surface-2);
  border-radius: var(--radius-2);
  box-shadow: var(--shadow-sm);
  transition: background-color var(--dur-2) var(--ease), border-color var(--dur-2) var(--ease);

  .hero-title {
    margin: 0;
    font-size: var(--step-2);
    line-height: 1.15;
    color: var(--color-heading);
  }

  .hero-description {
    margin-block: var(--space-2) 0;
    max-inline-size: 65ch;
    color: var(--color-text-muted);
  }
}

/* Theme toggle */
.theme-toggle {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding-block: 0.6rem;
  padding-inline: 0.85rem;
  border-radius: 999px;
  border: 1px solid var(--color-border);
  background: var(--color-surface);
  color: var(--color-text);
  cursor: pointer;
  box-shadow: 0 0 0 transparent;
  transition: transform var(--dur-1) var(--ease), background-color var(--dur-2) var(--ease),
    border-color var(--dur-2) var(--ease), box-shadow var(--dur-2) var(--ease);

  .theme-label {
    font-size: var(--step--1);
    font-weight: 600;
    letter-spacing: 0.2px;
  }

  /* Small “pressed” look for dark mode */
  &[aria-pressed="true"] {
    background: color-mix(in oklch, var(--color-surface) 70%, var(--brand-soft));
    border-color: color-mix(in oklch, var(--color-border) 60%, var(--brand));
  }

  &:hover {
    box-shadow: 0 0.6rem 1.2rem color-mix(in oklch, var(--color-shadow) 40%, transparent);
    transform: translateY(-1px);
  }

  &:active {
    transform: translateY(0px);
    background: color-mix(in oklch, var(--color-surface) 70%, var(--brand-weak));
  }

  /* make icons align nicely */
  :is(.theme-icon-light, .theme-icon-dark) {
    inline-size: 1.1rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }
}

/* Filters */
.filters {
  margin-block: var(--space-5) var(--space-4);

  .filter-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
  }
}

.filter-button {
  padding-block: 0.6rem;
  padding-inline: 0.9rem;
  border-radius: 999px;
  border: 1px solid var(--color-border);
  background: var(--color-surface);
  color: var(--color-text);
  cursor: pointer;
  transition: background-color var(--dur-2) var(--ease), border-color var(--dur-2) var(--ease),
    transform var(--dur-1) var(--ease);

  &:hover {
    border-color: color-mix(in oklch, var(--color-border) 55%, var(--color-primary));
    background: color-mix(in oklch, var(--color-surface) 82%, var(--brand-weak));
  }

  &:active {
    transform: translateY(1px);
  }

  &.active {
    background: var(--color-primary);
    border-color: color-mix(in oklch, var(--color-primary) 70%, black);
    color: white;
  }
}

/* Products grid */
.product-grid {
  display: grid;
  gap: var(--space-4);
  grid-template-columns: repeat(auto-fit, minmax(min(17rem, 100%), 1fr));
}

/* Cards */
.product-card {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-2);
  overflow: clip;
  box-shadow: var(--shadow-sm);
  transition: transform var(--dur-2) var(--ease), box-shadow var(--dur-2) var(--ease),
    border-color var(--dur-2) var(--ease), background-color var(--dur-2) var(--ease);

  /* modern selector example: if a card contains a button focused, elevate it */
  &:has(.product-button:focus-visible) {
    box-shadow: var(--shadow-lg);
    border-color: color-mix(in oklch, var(--color-border) 55%, var(--color-primary));
  }

  &:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }

  .product-image {
    aspect-ratio: 4 / 3;
    inline-size: 100%;
    object-fit: cover;
    background: color-mix(in oklch, var(--color-surface) 70%, var(--neutral-2));
  }

  .product-content {
    padding: var(--space-4);
    display: grid;
    gap: var(--space-2);
  }

  .product-title {
    margin: 0;
    font-size: var(--step-1);
    line-height: 1.2;
    color: var(--color-heading);
  }

  .product-description {
    margin: 0;
    color: var(--color-text-muted);
  }

  .product-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-2);
    margin-block-start: var(--space-2);
  }

  .product-price {
    font-weight: 800;
    letter-spacing: 0.2px;
  }
}

.product-button {
  padding-block: 0.55rem;
  padding-inline: 0.9rem;
  border-radius: 0.8rem;
  border: 1px solid color-mix(in oklch, var(--color-primary) 70%, black);
  background: var(--color-primary);
  color: white;
  cursor: pointer;
  transition: background-color var(--dur-2) var(--ease), transform var(--dur-1) var(--ease),
    border-color var(--dur-2) var(--ease);

  &:hover {
    background: var(--color-primary-hover);
  }

  &:active {
    transform: translateY(1px);
    background: var(--color-primary-active);
  }
}

/* =========================
   RESPONSIVE TWEAKS
   ========================= */
@media (max-width: 520px) {
  .site-header {
    .header-content {
      padding-block: var(--space-2);
    }
  }

  .theme-toggle {
    padding-inline: 0.75rem;

    /* hide label on tiny screens but keep meaning via aria-label */
    .theme-label {
      display: none;
    }
  }

  .product-card {
    .product-footer {
      flex-direction: column;
      align-items: stretch;

      .product-button {
        inline-size: 100%;
      }
    }
  }
}

/* =========================
   SMALL “QUALITY” DETAIL:
   Make sure filter section spacing feels consistent
   ========================= */
main > :is(.hero, .filters, .products) {
  margin-block: 0;
}
main > :is(.hero, .filters, .products) + :is(.hero, .filters, .products) {
  margin-block-start: var(--space-5);
}